function getHeartPoint(t){var e=t/Math.PI,n=19.5*(16*Math.pow(Math.sin(e),3)),a=-20*(13*Math.cos(e)-5*Math.cos(2*e)-2*Math.cos(3*e)-Math.cos(4*e));return new Array(offsetX+n,offsetY+a)}function startHeartAnimation(){var t=50,e=10,n=new Array,a=setInterval(function(){for(var t=getHeartPoint(e),s=!0,o=0;o<n.length;o++){var i=n[o],r=Math.sqrt(Math.pow(i[0]-t[0],2)+Math.pow(i[1]-t[1],2));if(r<1.3*Garden.options.bloomRadius.max){s=!1;break}}s&&(n.push(t),garden.createRandomBloom(t[0],t[1])),e>=30?(clearInterval(a),showMessages()):e+=.2},t)}function timeElapse(t){}function showMessages(){adjustWordsPosition(),$("#messages").fadeIn(5e3,function(){showLoveU()})}function adjustWordsPosition(){$("#words").css("position","absolute"),$("#words").css("top",$("#garden").position().top+195),$("#words").css("left",$("#garden").position().left+70)}function adjustCodePosition(){$("#code").css("margin-top",($("#garden").height()-$("#code").height())/2)}function showLoveU(){$("#loveu").fadeIn(3e3)}var $window=$(window),gardenCtx,gardenCanvas,$garden,garden,clientWidth=$(window).width(),clientHeight=$(window).height();$(function(){$loveHeart=$("#loveHeart");$loveHeart.width()/2,$loveHeart.height()/2-55;$garden=$("#garden"),gardenCanvas=$garden[0],gardenCanvas.width=$("#loveHeart").width(),gardenCanvas.height=$("#loveHeart").height(),gardenCtx=gardenCanvas.getContext("2d"),gardenCtx.globalCompositeOperation="lighter",garden=new Garden(gardenCtx,gardenCanvas),$("#content").css("width",$loveHeart.width()+$("#code").width()),$("#content").css("height",Math.max($loveHeart.height(),$("#code").height())),$("#content").css("margin-top",Math.max(($window.height()-$("#content").height())/2,10)),$("#content").css("margin-left",Math.max(($window.width()-$("#content").width())/2,10)),setInterval(function(){garden.render()},Garden.options.growSpeed)}),$(window).resize(function(){var t=$(window).width(),e=$(window).height();t!=clientWidth&&e!=clientHeight&&location.replace(location)}),function(t){t.fn.typewriter=function(){return this.each(function(){var e=t(this),n=e.html(),a=0;e.html("");var s=setInterval(function(){var t=n.substr(a,1);"<"==t?a=n.indexOf(">",a)+1:a++,e.html(n.substring(0,a)+(1&a?"_":"")),a>=n.length&&clearInterval(s)},250)}),this}}(jQuery),$(function(){function t(t,e){var n=new Date,a=NaN,s=NaN,o=NaN,i=NaN,r=NaN,g=NaN;g=n.getSeconds()-t.getSeconds(),g<0&&(g+=60,n.setMinutes(n.getMinutes()-1)),r=n.getMinutes()-t.getMinutes(),r<0&&(r+=60,n.setHours(n.getHours()-1)),i=n.getHours()-t.getHours(),i<0&&(i+=24,n.setDate(n.getDate()-1)),1==e?(o=n.getDate()-t.getDate(),o<0&&(o+=getDaysInMonth(n.getMonth()),n.setDate(n.getDate()-1)),s=n.getMonth()-t.getMonth(),s<0&&(s+=12,n.setYear(n.getFullYear()-1)),a=n.getFullYear()-t.getFullYear()):o=Math.floor((n.getTime()-t.getTime())/864e5),i<10&&(i="0"+i),r<10&&(r="0"+r),g<10&&(g="0"+g);var d=a>0?'<span class="digit">'+a+"</span> 年 ":"";d+=s>=0?'<span class="digit">'+s+"</span> 月 ":"",d+='<span class="digit">'+o+"</span> 日 ",d+='<span class="digit">'+i+"</span> 时 ",d+='<span class="digit">'+r+"</span> 分 ",d+='<span class="digit">'+g+"</span> 秒",$("#elapseClock").html(d)}var e=new Date;e.setFullYear(2016,9,9),e.setHours(23),e.setMinutes(59),e.setSeconds(59),e.setMilliseconds(999),setTimeout(function(){startHeartAnimation()},7e3),t(e),setInterval(function(){t(e)},1e3)});
function Vector(t,n){this.x=t,this.y=n}function Petal(t,n,o,r,e,i){this.stretchA=t,this.stretchB=n,this.startAngle=o,this.angle=r,this.bloom=i,this.growFactor=e,this.r=1,this.isfinished=!1}function Bloom(t,n,o,r,e){this.p=t,this.r=n,this.c=o,this.pc=r,this.petals=[],this.garden=e,this.init(),this.garden.addBloom(this)}function Garden(t,n){this.blooms=[],this.element=n,this.ctx=t}Vector.prototype={rotate:function(t){var n=this.x,o=this.y;return this.x=Math.cos(t)*n-Math.sin(t)*o,this.y=Math.sin(t)*n+Math.cos(t)*o,this},mult:function(t){return this.x*=t,this.y*=t,this},clone:function(){return new Vector(this.x,this.y)},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},subtract:function(t){return this.x-=t.x,this.y-=t.y,this},set:function(t,n){return this.x=t,this.y=n,this}},Petal.prototype={draw:function(){var t,n,o,r,e=this.bloom.garden.ctx;t=new Vector(0,this.r).rotate(Garden.degrad(this.startAngle)),n=t.clone().rotate(Garden.degrad(this.angle)),o=t.clone().mult(this.stretchA),r=n.clone().mult(this.stretchB),e.strokeStyle=this.bloom.c,e.beginPath(),e.moveTo(t.x,t.y),e.bezierCurveTo(o.x,o.y,r.x,r.y,n.x,n.y),e.stroke()},render:function(){this.r<=this.bloom.r?(this.r+=this.growFactor,this.draw()):this.isfinished=!0}},Bloom.prototype={draw:function(){var t,n=!0;this.garden.ctx.save(),this.garden.ctx.translate(this.p.x,this.p.y);for(var o=0;o<this.petals.length;o++)t=this.petals[o],t.render(),n*=t.isfinished;this.garden.ctx.restore(),1==n&&this.garden.removeBloom(this)},init:function(){for(var t=360/this.pc,n=Garden.randomInt(0,90),o=0;o<this.pc;o++)this.petals.push(new Petal(Garden.random(Garden.options.petalStretch.min,Garden.options.petalStretch.max),Garden.random(Garden.options.petalStretch.min,Garden.options.petalStretch.max),n+o*t,t,Garden.random(Garden.options.growFactor.min,Garden.options.growFactor.max),this))}},Garden.prototype={render:function(){for(var t=0;t<this.blooms.length;t++)this.blooms[t].draw()},addBloom:function(t){this.blooms.push(t)},removeBloom:function(t){for(var n,o=0;o<this.blooms.length;o++)if(n=this.blooms[o],n===t)return this.blooms.splice(o,1),this},createRandomBloom:function(t,n){this.createBloom(t,n,Garden.randomInt(Garden.options.bloomRadius.min,Garden.options.bloomRadius.max),Garden.randomrgba(Garden.options.color.rmin,Garden.options.color.rmax,Garden.options.color.gmin,Garden.options.color.gmax,Garden.options.color.bmin,Garden.options.color.bmax,Garden.options.color.opacity),Garden.randomInt(Garden.options.petalCount.min,Garden.options.petalCount.max))},createBloom:function(t,n,o,r,e){new Bloom(new Vector(t,n),o,r,e,this)},clear:function(){this.blooms=[],this.ctx.clearRect(0,0,this.element.width,this.element.height)}},Garden.options={petalCount:{min:8,max:15},petalStretch:{min:.1,max:3},growFactor:{min:.1,max:1},bloomRadius:{min:8,max:10},density:10,growSpeed:1e3/60,color:{rmin:128,rmax:255,gmin:0,gmax:128,bmin:0,bmax:128,opacity:.1},tanAngle:60},Garden.random=function(t,n){return Math.random()*(n-t)+t},Garden.randomInt=function(t,n){return Math.floor(Math.random()*(n-t+1))+t},Garden.circle=2*Math.PI,Garden.degrad=function(t){return Garden.circle/360*t},Garden.raddeg=function(t){return t/Garden.circle*360},Garden.rgba=function(t,n,o,r){return"rgba("+t+","+n+","+o+","+r+")"},Garden.randomrgba=function(t,n,o,r,e,i,a){var s=Math.round(Garden.random(t,n)),h=Math.round(Garden.random(o,r)),d=Math.round(Garden.random(e,i)),c=5;return Math.abs(s-h)<=c&&Math.abs(h-d)<=c&&Math.abs(d-s)<=c?Garden.rgba(t,n,o,r,e,i,a):Garden.rgba(s,h,d,a)};